extends ./layout/layout_main.pug

block css
  style.
    .logged-in {
      display: block !important;
    }
    .logged-out {
      display: none;
    }
  //- style


block content
  div(Zng-app="myApp" Zng-controller="myCtrl" ng-cloak, directive="")
    
    .banner.userprofile.seller(ng-style="{'background-image': 'url(' + supplier.banner + ')'}")
      .gradient
      .container.banner-btn-wrap
        .btns
          a.btn.btn-default.btn-sm.editprofile(href='#modal_coming_soon', data-toggle='modal') edit profile
          a.btn.btn-default.btn-sm.editprofile(href='#modal_coming_soon', data-toggle='modal') preview public profile
        //- btns
      //- container
      
      .info
        .container
          .row
            .col-sm-3.col-md-3
              .photo
                .img.square
                  a(href='#modal_coming_soon', data-toggle='modal')
                    i.fa.fa-camera
                  //- a
                  img(ng-src="{{supplier.logo}}", alt="")
                //- img
                .name
                  span {{supplier.supplier_name}}&nbsp;
                  //- sup
                  //-   a(href='#modal_coming_soon', data-toggle='modal')
                  //-     i.fa.fa-pencil
                  //-     span edit profile
                  //-   //- a
                  //- //- sup
                  br
                  small.hide.NOTYET
                    | Winery &amp; Vineyard
                  br
                //- name
              //- photo
            //- col-md-3
          //- row
          .row
            .col-sm-9.col-md-9.col-sm-offset-3.col-md-offset-3
              .userprofilemenu
                nav.menu
                  .btn-add-friend
                    | &nbsp;
                    a.btn.btn-success.btn-sm(href="#")
                      | Follow
                    //- a
                  //- btn-add-friend
                  ul
                    li
                      a.active(href='') News
                    //- li
                    li
                      a(href="shop.html?supplier={{supplierId}}") Shop
                    li
                      a(href="supplier-maint.html?supplier={{supplierId}}") Maintenance
                    //- li
                    li
                      a(href='#modal_coming_soon', data-toggle='modal').hide.NOTYET Like
                    //- li
                    li
                      a(href='#modal_coming_soon', data-toggle='modal').hide.NOTYET Message
                    //- li
                    li
                      a(href='#modal_coming_soon', data-toggle='modal').hide.NOTYET Save
                    //- li
                    li
                      a(href="seller-about.html").hide.NOTYET About
                    //- li
                    li
                      a(href='#modal_coming_soon', data-toggle='modal').hide.NOTYET Photos
                    //- li
                    li
                      a(href="seller-reviews.html").hide.NOTYET Reviews
                    //- li
                    li
                      a(href='#modal_coming_soon', data-toggle='modal').hide.NOTYET Events
                    //- li
                  //- ul
                //- nav
              //- userprofilemenu
            //- col-md-6
          //- row
        //- container
      //- info
    //- banner-home

    section.userprofile
      .container
        .row
          .col-md-3
            br
            .intro
              h4 Winery &amp; Vineyard &middot; Pokolbin, New South Wales
              .rating-status
                | 4.6
                .stars
                  i.fa.fa-star
                  i.fa.fa-star
                  i.fa.fa-star
                  i.fa.fa-star
                  i.fa.fa-star-half-o
                //- stars
              //- rating-status
            //- intro
            .search.page.hide.NOTYET
              a(href="#", target="_blank")
                i.fa.fa-search
              //- a
              input.form-control(type='text', placeholder='search for posts on this page...')
            //- search
            .list_groups.sellerinfo
              .content
                .input-group
                  span.input-group-addon
                    i.fa.fa-users
                  span.form-control
                    a(href='#modal_coming_soon', data-toggle='modal') 4,842 people like this
                    //- p
                  //- span
                //- input-group
                .input-group
                  span.input-group-addon
                    i.fa.fa-map-marker
                  span.form-control
                    a(href='#modal_coming_soon', data-toggle='modal') 2,982 people have been here
                    //- p
                  //- span
                //- input-group
                .input-group
                  span.input-group-addon
                    i.fa.fa-clock-o
                  span.form-control
                    a(href='#modal_coming_soon', data-toggle='modal')
                      | Open · 9:30AM - 5:00PM
                      br
                      | Get additional info
                    //- p
                  //- span
                //- input-group
                .input-group
                  span.input-group-addon
                    i.fa.fa-user-plus
                  span.form-control
                    a(href='#modal_coming_soon', data-toggle='modal')
                      | Invite friends to like this Page
                    //- p
                  //- span
                //- input-group
                .form-group.text-center.linetop
                  a(href="shop.html?supplier={{supplierId}}")
                    button.btn.btn-success shop now

                //- input-group
              //- content
            //- sellerinfo
            
            .intro.sibling.hide.NOTYET
              .livecircles
                h4.text
                  a(href='#modal_coming_soon', data-toggle='modal')
                    .count 884 circlebuys
                  //- a
                //- h4
              //- livecircles
            //- intro
            
            .list_groups.sellerinfo
              .content
                h4
                  a(href='#modal_coming_soon', data-toggle='modal') About
                //- h4
                .map
                  img(src="assets/images/static_map.png", alt="")
                //-
                .input-group
                  span.input-group-addon
                    i.fa.fa-share
                  span.form-control
                    a(href='#modal_coming_soon', data-toggle='modal') 401-427 McDonalds Rd Pokolbin, NSW
                    //- p
                  //- span
                //- input-group
                .input-group
                  span.input-group-addon
                    i.fa.fa-phone
                  span.form-control
                    a(href='#modal_coming_soon', data-toggle='modal') +61 2 4998 7559
                    //- p
                  //- span
                //- input-group
                .input-group
                  span.input-group-addon
                    i.fa.fa-clock-o
                  span.form-control
                    a(href='#modal_coming_soon', data-toggle='modal')
                      | Open
                      br
                      | Today 9:30AM - 5:00PM
                    //- p
                  //- span
                //- input-group
                .input-group
                  span.input-group-addon
                    i.fa.fa-question-circle-o
                  span.form-control
                    a(href='#modal_coming_soon', data-toggle='modal')
                      | Ask for Brokenwood Wines's price range
                    //- p
                  //- span
                //- input-group
              //- content
            //- sellerinfo
            
            
            photos-summary(heading="Photos")

            
          //- col-md-3
          
          
          
          
          //
          //  This is the section with the posts.
          //
          
          .col-md-6
            
            pastac-crowdhound-posts(anchor="$supplier-page-{{supplierId}}", root-element-type="supplier-page")








            .timeline.hide.NOTYET
              .form-icon.left
                input.form-control(type='text', placeholder='Search for a post...')
                a.icon(href='#modal_coming_soon', data-toggle='modal')
                  i.fa.fa-search
                //- a
              //- form-icon
            //- timeline

            .timeline.hide.NOTYET
              .content
                .head
                  .user
                    .img
                      img(src="assets/images/producers/brokenwood/logo.jpg", alt="")
                    //- img
                    a(href="seller.html") Brokenwood Wines
                  //- user
                  .more
                    a(href='#modal_coming_soon', data-toggle='modal')
                      i.fa.fa-chevron-down
                    //- a
                  //- more
                //- header
                .inner
                  .caption
                    p RRP $65 End of bin clearance exclusive to our circle followers $29 be quick 200 cases only...&nbsp;
                      a(href='#modal_coming_soon', data-toggle='modal') see more
                  //- caption
                  .post
                    .shared
                      img(src="assets/images/activity/image-6.png", alt="")
                    //- shared
                  //- post
                //- inner
                br
                a(href='#modal_coming_soon', data-toggle='modal')
                  i.fa.fa-heart
                  | &nbsp;216
              //- content
              .controls
                a(href='#modal_coming_soon', data-toggle='modal')
                  i.fa.fa-heart
                  | Like
                //- a
                a(href='#modal_coming_soon', data-toggle='modal')
                  i.fa.fa-comment
                  | Comment
                //- a
                a(href='#modal_coming_soon', data-toggle='modal')
                  i.fa.fa-share
                  | Share
                //- a
              //- controls
              .footer
                .comments
                  .input-group
                    span.input-group-addon
                      .thumb
                        .img
                          img(src="assets/images/users/user_3.jpg", alt="")
                        //- img
                      //- thumb
                    //- input-group-addon
                    span.form-control
                      strong
                        a(href="#", target="_blank") Darren Crone
                      //- strong
                      | Hey mate this came through this morning I'm down for 3 cases better jump on it straight away?
                      p
                        a(href='#modal_coming_soon', data-toggle='modal') Like
                        | &nbsp;&middot;&nbsp;
                        a(href='#modal_coming_soon', data-toggle='modal') Reply
                        | &middot;
                        small &nbsp;May 15 at 9:53am
                  //- input-group
                  .indent
                    .input-group
                      span.input-group-addon
                        .thumb
                          .img
                            img(src="assets/images/img_advisor_1.jpg", alt="")
                          //- img
                        //- thumb
                      //- input-group-addon
                      span.form-control
                        strong
                          a(href="profile.html") Andrew Steer
                        //- strong
                        | thanks for the heads up mate I just ordered 3 cases too. Passed it on Phil and Arv as well! Hope they're not too late it's nearly all gone!
                        p
                          a(href='#modal_coming_soon', data-toggle='modal') Like
                          | &nbsp;&middot;&nbsp;
                          a(href='#modal_coming_soon', data-toggle='modal') Reply
                          | &middot;
                          small &nbsp;May 15 at 10:55am
                    //- input-group
                    .input-group
                      span.input-group-addon
                        .thumb
                          .img
                            img(src="assets/images/users/user_4.jpg", alt="")
                          //- img
                        //- thumb
                      //- input-group-addon
                      span.form-control
                        strong
                          a(href="#", target="_blank") Phil Callender
                        //- strong
                        | thanks Darren just managed to get 2 cases but Arv missed out! Let me know if any other buys like that come up and I'll do the same.
                        p
                          a(href='#modal_coming_soon', data-toggle='modal') Like
                          | &nbsp;&middot;&nbsp;
                          a(href='#modal_coming_soon', data-toggle='modal') Reply
                          | &middot;
                          small &nbsp;May 15 at 11:23am
                    //- input-group
                  //- indent
                //- comments
                .comment
                  .input-group
                    span.input-group-addon
                      .thumb
                        .img
                          img(src="assets/images/producers/brokenwood/logo.jpg", alt="")
                        //- img
                      //- thumb
                    //- input-group-addon
                    input.form-control(type='text', placeholder='Write a comment...')
                    span.input-group-addon
                      a(href='#modal_coming_soon', data-toggle='modal')
                        i.fa.fa-camera
                      //- a
                    //- input-group-addon
                  //- input-group
                //- comment
              //- footer
            //- timeline
            
            .timeline.hide.NOTYET
              .content
                .head
                  .user
                    .img
                      img(src="assets/images/producers/brokenwood/logo.jpg", alt="")
                    //- img
                    a(href="seller.html") Brokenwood Wines
                  //- user
                  .more
                    a(href='#modal_coming_soon', data-toggle='modal')
                      i.fa.fa-chevron-down
                    //- a
                  //- more
                //- header
                .inner
                  .caption
                    p Join us on the waterfront at the beautiful Anchorage, Port Stephens to celebrate the release of the much anticipated, award winning 2014 Graveyard Vineyard Shiraz. To book your seats contact the Events Team on (02) 4984 0350 or events@anchorageportstephens.com.au
                  //- caption
                  .post
                    .shared
                      img(src="assets/images/posts/p1.jpg", alt="")
                    //- shared
                  //- post
                //- inner
                br
                a(href='#modal_coming_soon', data-toggle='modal')
                  i.fa.fa-heart
                  | &nbsp;111
              //- content
              .controls
                a(href='#modal_coming_soon', data-toggle='modal')
                  i.fa.fa-heart
                  | Like
                //- a
                a(href='#modal_coming_soon', data-toggle='modal')
                  i.fa.fa-comment
                  | Comment
                //- a
                a(href='#modal_coming_soon', data-toggle='modal')
                  i.fa.fa-share
                  | Share
                //- a
              //- controls
              .footer
                .comments
                  .input-group
                    span.input-group-addon
                      .thumb
                        .img
                          img(src="assets/images/users/user_5.jpg", alt="")
                        //- img
                      //- thumb
                    //- input-group-addon
                    span.form-control
                      strong
                        a(href="#", target="_blank") Cathy Gadd
                      //- strong
                      | Looking forward to this, should be awesome !
                      p
                        a(href='#modal_coming_soon', data-toggle='modal') Like
                        | &nbsp;&middot;&nbsp;
                        a(href='#modal_coming_soon', data-toggle='modal') Reply
                        | &middot;
                        small &nbsp;May 8 at 6:58am
                  //- input-group
                  .input-group
                    span.input-group-addon
                      .thumb
                        .img
                          img(src="assets/images/users/user_6.jpg", alt="")
                        //- img
                      //- thumb
                    //- input-group-addon
                    span.form-control
                      strong
                        a(href="#", target="_blank") Graeme Brunton
                      //- strong
                      | See you there Mal I'll be in room 32
                      p
                        a(href='#modal_coming_soon', data-toggle='modal') Like
                        | &nbsp;&middot;&nbsp;
                        a(href='#modal_coming_soon', data-toggle='modal') Reply
                        | &middot;
                        small &nbsp;May 21 at 6:01pm
                  //- input-group
                  .input-group
                    span.input-group-addon
                      .thumb
                        .img
                          img(src="assets/images/users/user_7.jpg", alt="")
                        //- img
                      //- thumb
                    //- input-group-addon
                    span.form-control
                      strong
                        a(href="#", target="_blank") Kathy Coombe
                      //- strong
                      | This sounds a bit special Caitlin Coombe.
                      p
                        a(href='#modal_coming_soon', data-toggle='modal') Like
                        | &nbsp;&middot;&nbsp;
                        a(href='#modal_coming_soon', data-toggle='modal') Reply
                        | &middot;
                        small &nbsp;May 21 at 9:13am
                  //- input-group
                  .input-group
                    span.input-group-addon
                      .thumb
                        .img
                          img(src="assets/images/users/user_8.jpg", alt="")
                        //- img
                      //- thumb
                    //- input-group-addon
                    span.form-control
                      strong
                        a(href="#", target="_blank") Melissa-Jane Laney
                      //- strong
                      a(href='#modal_coming_soon', data-toggle='modal') Alisha-jane Laney
                      p
                        a(href='#modal_coming_soon', data-toggle='modal') Like
                        | &nbsp;&middot;&nbsp;
                        a(href='#modal_coming_soon', data-toggle='modal') Reply
                        | &middot;
                        small &nbsp;May 12 at 5:55am
                  //- input-group
                //- comments
                .comment
                  .input-group
                    span.input-group-addon
                      .thumb
                        .img
                          img(src="assets/images/producers/brokenwood/logo.jpg", alt="")
                        //- img
                      //- thumb
                    //- input-group-addon
                    input.form-control(type='text', placeholder='Write a comment...')
                    span.input-group-addon
                      a(href='#modal_coming_soon', data-toggle='modal')
                        i.fa.fa-camera
                      //- a
                    //- input-group-addon
                  //- input-group
                //- comment
              //- footer
            //- timeline
          //- col-md-6
          
          
          //
          //  This is the right column
          //
          .col-md-3

            reviews-summary(heading="Reviews")

            activity-summary(heading="Latest Activity" hero="ctrl.hero" on-done="heroDetailClick(val)")

            .list_search_groups.messaging.hide.NOTYET
              .head
                h4 Live chat
              //- head
              .content
                .input-group
                  span.input-group-addon
                    .thumb
                      .img
                        img(src='assets/images/users/user_3.jpg', alt='')
                      //- img
                    //- thumb
                  span.form-control
                    a.online(href="#") Darren Crone
                    small online
                    //- p
                  //- span
                //- input-group
                .input-group
                  span.input-group-addon
                    .thumb
                      .img
                        img(src='assets/images/users/user_2.jpg', alt='')
                      //- img
                    //- thumb
                  span.form-control
                    a.offline(href="#") Rodan Luzuriaga
                    small 2hours ago
                    //- p
                  //- span
                //- input-group
                .input-group
                  span.input-group-addon
                    .thumb
                      .img
                        img(src='assets/images/users/user_1.jpg', alt='')
                      //- img
                    //- thumb
                  span.form-control
                    a.online(href="profile.html") Andrew Steer
                    small online
                    //- p
                  //- span
                //- input-group
              //- content
              .search
                input.form-control(type='text')
                a.new(href="#")
                  i.fa.fa-pencil-square-o
                //- a
              //- search
            //- messaging

            .list_groups.events.hide.NOTYET
              .head
                h4
                  a(href='#modal_coming_soon', data-toggle='modal') Events
              //- head
              .content
                .input-group
                  span.input-group-addon
                    .thumb
                      .img
                        img(src='assets/images/producers/brokenwood/logo.jpg', alt='')
                      //- img
                    //- thumb
                  span.form-control
                    a(href='#modal_coming_soon', data-toggle='modal')
                      strong Captain's Table Dinner - Monthly
                    br
                    | Brokenwood Wines
                    br
                    small Fri, 03/06/2016
                      br
                      | 5:30 PM
                    //- p
                  //- span
                //- input-group
                .input-group
                  span.input-group-addon
                    .thumb
                      .img
                        img(src='assets/images/producers/brokenwood/logo.jpg', alt='')
                      //- img
                    //- thumb
                  span.form-control
                    a(href='#modal_coming_soon', data-toggle='modal')
                      strong The Grazing Blaze
                    br
                    | Brokenwood Wines
                    br
                    small Sat, 11/06/2016
                      br
                      | 4:00 PM to 8:00 PM
                    //- p
                  //- span
                //- input-group
              //- content
              .more
                a(href='#modal_coming_soon', data-toggle='modal') See all
              //- more
            //- list_groups

            likes-summary(heading="Liked by this page" anchor="'$supplier-page-'+supplierId")

          //- col-md-3
        //- row
      //- container
    //- section


block scripts
  // External Script goes here...
  
  // See https://github.com/danialfarid/ng-file-upload
  //script(src='bower_components/ng-file-upload/ng-file-upload-shim.min.js', type="text/javascript")
  script(src='bower_components/ng-file-upload/ng-file-upload.min.js', type="text/javascript")
  script(src='bower_components/cloudinary/js/jquery.cloudinary.js', type="text/javascript")
  
  script(src='assets/vendor/pastac/reviews-summary/reviews-summary.js', type="text/javascript")
  script(src='assets/vendor/pastac/activity-summary/activity-summary.js', type="text/javascript")
  script(src='assets/vendor/pastac/likes-summary/likes-summary.js', type="text/javascript")
  script(src='assets/vendor/pastac/photos-summary/photos-summary.js', type="text/javascript")
  script(src='assets/vendor/pastac/pastac-crowdhound-posts/pastac-crowdhound-posts.js', type="text/javascript")
  
  
  script(src='assets/scripts/seller.js', type="text/javascript")
  script.
    var app = angular.module('myApp', ['ngSanitize', /*'ckeditor', 'ngFileUpload',*/ 'pastac-login']);
    app.controller('pageCtrl', function($scope, $http, $timeout, $compile /*, authserviceApi */) {
    
      // Get the "supplierId" parameter from the URL.
      var supplierId = null;
      console.log('window.location=' + window.location + '.')
      window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(str, key, value) {
        //console.log('xx:' + key + ':' + value + ':');
        if (key === 'supplier') {
          supplierId = value;
        }
      });
      console.log('Displaying the page for supplierId=' + supplierId);
      if ( !supplierId) {
        window.location.href = 'index.html';
      }

      // Initialize Angular, Teaservice, Crowdhound, and Authservice
      var htmlElementSelector = '#timelineSection';
      Seller.init(supplierId, htmlElementSelector, function(err) {
        
      });
    });
      

    /*
     *  Set up the login part at the top of the page.
    authservice.init({
      // Environment specific values are defined in environment.js
      host: AUTHSERVICE_HOST,
      port: AUTHSERVICE_PORT,
      tenant: AUTHSERVICE_TENANT,
      pretend: AUTHSERVICE_USE_DUMMY_LOGIN,
      onUserChange: function(user, ttuat, fromCookie) {
        // If the current user came from the cookie, reload it
        if (fromCookie) {
          console.log('Reloading user details (cookie details are just a summary)');
          return authservice.reloadUser();
        }
      }
    });
    */

    
    // Templates for Crowdhound
  script(id='timelineList', type='text/template')
    <<{childrenHtml}>>


  script(id='timelinePost', type='text/template')
    <<#element>>


      .timeline(data-owner-id="<<user.userId>>" data-post-id="<<id>>")

          .content
              .head
                  .user
                      .img
                          img.minAvatar(src="<<user.avatar>>" alt="")
                      a(href="/profile.html?user=<<user.userId>>")
                        | <<user.firstName>> <<user.lastName>>
                  <div class="more">
                      <ul class="nav navbar-nav navbar-right">
                          <li class="dropdown">
                              <ul class="dropdown-menu" style="top: 35px;">
                              //{{#scopes.isUserLoggedIn}}
                              //    <li><a id="deletePost" href="javascript:void(0);" onclick="TimelinePost.deletePost(<<id>>, <<parentId>>, <<rootId>>);">Delete</a></li>
                              //    <li><a id="editPost" href="javascript:void(0);">Edit</a></li>
                              //{{/scopes.isUserLoggedIn}}
                              //{{^scopes.isUserLoggedIn}}
                                <li><a id="hidePost" href="javascript:void(0);">Hide</a></li>
                              //{{/scopes.isUserLoggedIn}}
                              </ul>
                              <a aria-expanded="false" aria-haspopup="true" class="dropdown-toggle info postToggle" data-toggle="dropdown" href="#" role="button"><i class="fa fa-chevron-down"></i></a>

                          </li>
                      </ul>
                  </div>
              //- .head
              .inner
                  .caption
                      p
                        |  <<{description}>>

                  <<{htmlLinkPost}>>
              //- .inner
              
              <div id="post-likes-<<id>>" style="display :<<#likes>>block<</likes>> <<^likes>>none<</likes>>;">
                <br/>
                <a href="#"><i class="fa fa-heart"></i>&nbsp;<span id="post-likes-counter-<<id>>"><<likes>></span></a>
              </div>
          //- .content
          
          <<#_cloudinaryImage_raw>>
            <img class="img-responsive" src="<<_cloudinaryImage_lowquality>>" srcset="<<_cloudinaryImage_320>> 320w, <<_cloudinaryImage_480>> 480w, <<_cloudinaryImage_768>> 768w, <<_cloudinaryImage_992>> 992w, <<_cloudinaryImage_1200>> 1200w, <<_cloudinaryImage_1920>> 1920w" sizes="(max-width: 30em) 30em, 100vw" style="width:100%;">
          <</_cloudinaryImage_raw>>
          
          .controls
              <<^liked>>
                a(id="post-like-anchor-<<id>>" href="javascript:void(0);" onclick="TimelinePost.like(<<id>>, 1);")
                  i.fa.fa-heart
                  | Like
                //- a
              <</liked>>
              <<#liked>>
                <a id="post-like-anchor-<<id>>" href="javascript:void(0);" onclick="TimelinePost.like(<<id>>, 0);"><i class="fa fa-heart"></i>Unlike</a>
              <</liked>>
              <a href="javascript:void(0);" onclick="TimelinePost.toogleComment(<<id>>);"><i class="fa fa-comment"></i>Comment</a>
              <div class="fb-share-button" data-href="<<user.shareLink>>/<<id>>" data-layout="button_count">
              </div>
          //- .controls
          
          <div class="footer">
              <div id="comments-<<id>>" class="comments">
                  <<{childrenHtml}>>
              </div>
              <div id="comment-<<id>>" class="comment" style="display:none;">
                  <div class="input-group">
                      <span class="input-group-addon">
                          <div class="thumb">
                              <div class="img">
                                  <img src="<<user.avatar>>" alt="">
                              </div>
                          </div>
                      </span>
                      <input class="form-control" type="text" placeholder="Write a comment..."><span class="input-group-addon"><a href="javascript:void(0);" onclick="TimelinePost.commentOnAPost(<<id>>)"><i class="fa fa-send"></i></a></span>
                  </div>
              </div>
          </div>
      </div>
    <</element>>


  script(id='timelinePostComment', type='text/template')
    <<#element>>
      <div class="input-group">
          <span class="input-group-addon">
              <div class="thumb">
                    <div class="img">
                        <img src="<<user.avatar>>" alt="">
                    </div>
              </div>
              </span><span class="form-control"><strong><a href="<<user.communityPage>>"><<user.firstName>> <<user.lastName>></a></strong> <<description>>
              <p>
                  <a href="#">Like</a>&nbsp;·&nbsp;<a href="#">Reply</a>·<small>&nbsp<<createdDateFromNow>></small>
              </p>
          </span>
      </div>
    <</element>>
